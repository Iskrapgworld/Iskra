<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ò–°–ö–†–ê: –ú–∏—Ä PG</title>
  <style>
    body {
      margin: 0;
      background-color: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      touch-action: manipulation;
    }
    h1 { color: #ffa500; margin: 10px 0; font-size: 1.5rem; }

    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background: #6622cc;
      color: white;
    }

    .screen {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: #111;
      color: #fff;
      z-index: 999;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    #mainMenu {
      display: flex;
    }

    #mineBoard {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 4px;
      width: 360px;
      margin: 10px auto;
    }

    .cell {
      width: 58px;
      height: 58px;
      border-radius: 6px;
      background: #333;
    }
  </style>
</head>
<body>
  <h1>üî• –ò–°–ö–†–ê: –ú–∏—Ä PG üî•</h1>

  <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
  <div id="mainMenu" class="screen">
    <h2>–ú–µ–Ω—é</h2>
    <button onclick="showBattle()">–í –±–æ–π</button>
    <button onclick="showMine()">–®–∞—Ö—Ç–∞</button>
    <button onclick="showCharacter()">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –±–æ—è -->
  <div id="battleScreen" class="screen">
    <h2>‚öî –ë–æ–π</h2>
    <div id="battlePlaceholder">–ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–ª–µ –±–∏—Ç–≤—ã</div>
    <button onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
  </div>

  <!-- –≠–∫—Ä–∞–Ω —à–∞—Ö—Ç—ã -->
  <div id="mineScreen" class="screen">
    <h2>‚õè –®–∞—Ö—Ç–∞ –ò—Å–∫—Ä—ã</h2>
    <div id="mineStatus">–ì–ª—É–±–∏–Ω–∞: 0, –ò—Å–∫—Ä—ã: 0, –í–æ–∑–¥—É—Ö: 100, –°–≤–æ–¥: 100</div>
    <div id="mineBoard"></div>
    <button onclick="nextMineTurn()">–°–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥</button>
    <button onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ -->
  <div id="charScreen" class="screen">
    <h2>üìú –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h2>
    <div>–û–ø—ã—Ç: <span id="xp">0</span> | –û—á–∫–∏: <span id="skillPoints">0</span></div>
    <div>–°–∏–ª–∞: <span id="str">1</span> <button onclick="upgrade('str')">+</button></div>
    <div>–õ–æ–≤–∫–æ—Å—Ç—å: <span id="agi">1</span> <button onclick="upgrade('agi')">+</button></div>
    <div>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: <span id="int">1</span> <button onclick="upgrade('int')">+</button></div>
    <div>–ñ–∏–≤—É—á–µ—Å—Ç—å: <span id="vit">1</span> <button onclick="upgrade('vit')">+</button></div>
    <div>–£–¥–∞—á–∞: <span id="luck">1</span> <button onclick="upgrade('luck')">+</button></div>
    <button onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
  </div>
  <script>
let currentScreen = "main";
let xp = 0;
let skillPoints = 0;
let attributes = {
  str: 1,
  agi: 1,
  int: 1,
  vit: 1,
  luck: 1
};

let mineDepth = 1;
let spark = 1000;
let air = 100;
let vault = 100;
let mineBoard = [];
const colors = ['red', 'green', 'blue', 'orange', 'purple'];

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
  document.getElementById(id).style.display = 'flex';
  currentScreen = id;
  if (id === 'mineScreen') updateMineUI();
  if (id === 'charScreen') updateCharUI();
}

function backToMenu() {
  showScreen("mainMenu");
}

function showBattle() {
  showScreen("battleScreen");
  document.getElementById("battlePlaceholder").textContent = "‚ö† –ë–æ–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ.";
}

function showMine() {
  showScreen("mineScreen");
  generateMineBoard();
}

function showCharacter() {
  showScreen("charScreen");
}

function updateCharUI() {
  document.getElementById("xp").textContent = xp;
  document.getElementById("skillPoints").textContent = skillPoints;
  for (let attr in attributes) {
    document.getElementById(attr).textContent = attributes[attr];
  }
}

function upgrade(attr) {
  if (skillPoints > 0 && attributes[attr] < 10) {
    attributes[attr]++;
    skillPoints--;
    updateCharUI();
  }
}

function generateMineBoard() {
  const container = document.getElementById("mineBoard");
  container.innerHTML = "";
  mineBoard = [];
  for (let i = 0; i < 36; i++) {
    const el = document.createElement("div");
    const color = colors[Math.floor(Math.random() * colors.length)];
    el.className = `cell ${color}`;
    container.appendChild(el);
    mineBoard.push({ el, color });
  }
}

function updateMineUI() {
  document.getElementById("mineStatus").innerHTML =
    `–ì–ª—É–±–∏–Ω–∞: ${mineDepth}, –ò—Å–∫—Ä—ã: ${spark}, –í–æ–∑–¥—É—Ö: ${air}, –°–≤–æ–¥: ${vault}`;
}

function nextMineTurn() {
  if (air <= 0 || vault <= 0) {
    alert("–®–∞—Ö—Ç–∞ –æ–±—Ä—É—à–∏–ª–∞—Å—å –∏–ª–∏ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è –≤–æ–∑–¥—É—Ö!");
    spark = Math.max(0, spark - 50);
    mineDepth = 1;
    air = 100;
    vault = 100;
    generateMineBoard();
    updateMineUI();
    return;
  }

  // –í–æ–∑–¥—É—Ö –∏ —Å–≤–æ–¥—ã —É–º–µ–Ω—å—à–∞—é—Ç—Å—è
  air -= 5;
  vault -= 5;

  // –£—Ä–æ–Ω –ø–æ –ø–ª–∞—Å—Ç—É
  let damage = Math.floor(10 + attributes.str * 2 + Math.random() * 5);
  let percent = Math.floor((damage / getLayerHp(mineDepth)) * 100);
  spark += percent;

  // –®–∞–Ω—Å –Ω–∞ —Ä–µ—Å—É—Ä—Å
  let res = getResourceDrop();
  if (res) {
    spark += res.amount;
    float(`${res.type} +${res.amount}`, "mineStatus");
  }

  // –£–≥–ª—É–±–ª–µ–Ω–∏–µ —à–∞—Ö—Ç—ã –∫–∞–∂–¥—ã–µ 5 —Ö–æ–¥–æ–≤
  if (Math.random() < 0.2) {
    mineDepth++;
    air = 100;
    vault = 100;
    generateMineBoard();
  }

  updateMineUI();
}

function getLayerHp(depth) {
  if (depth === 1) return 100;
  if (depth === 2) return 150;
  return 300;
}

function getResourceDrop() {
  const rand = Math.random() * 100;
  if (mineDepth === 1) {
    if (rand < 5) return { type: "üíé –ö—Ä–∏—Å—Ç–∞–ª–ª", amount: 20 };
    if (rand < 25) return { type: "ü•á –ó–æ–ª–æ—Ç–æ", amount: 10 };
    if (rand < 75) return { type: "‚õì –ú–µ—Ç–∞–ª–ª", amount: 5 };
  }
  if (mineDepth === 2) {
    if (rand < 10) return { type: "üíé –ö—Ä–∏—Å—Ç–∞–ª–ª", amount: 25 };
    if (rand < 40) return { type: "ü•á –ó–æ–ª–æ—Ç–æ", amount: 15 };
    if (rand < 90) return { type: "‚õì –ú–µ—Ç–∞–ª–ª", amount: 8 };
  }
  if (mineDepth >= 3) {
    if (rand < 20) return { type: "üíé –ö—Ä–∏—Å—Ç–∞–ª–ª", amount: 30 };
    if (rand < 70) return { type: "ü•á –ó–æ–ª–æ—Ç–æ", amount: 20 };
    return { type: "‚õì –ú–µ—Ç–∞–ª–ª", amount: 10 };
  }
  return null;
}

function float(text, targetId) {
  const el = document.createElement("div");
  el.textContent = text;
  el.className = "floatText";
  const rect = document.getElementById(targetId).getBoundingClientRect();
  el.style.position = "absolute";
  el.style.left = rect.left + 50 + "px";
  el.style.top = rect.top + "px";
  el.style.color = "#0f0";
  el.style.fontWeight = "bold";
  el.style.animation = "floatUp 1s ease-out forwards";
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 1000);
}

// –ó–∞–ø—É—Å–∫
showScreen("mainMenu");
</script>
</body>
</html>
