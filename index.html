<!DOCTYPE html><html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ò–°–ö–†–ê: –ë–∏—Ç–≤–∞ v1.4</title>
  <style>
    body {
      margin: 0;
      background-color: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
    }
    h1 {
      color: #ffa500;
      margin: 10px 0;
    }
    #topBar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px 10px;
      font-size: 14px;
    }
    #timerBarContainer {
      flex-grow: 1;
      height: 10px;
      margin: 0 10px;
      background: #444;
      border-radius: 5px;
      overflow: hidden;
    }
    #timerBar {
      height: 100%;
      width: 100%;
      background: linear-gradient(90deg, #33ff33, #ffff00);
      transition: width 1s linear;
    }
    #battleLog {
      margin: 5px;
      padding: 4px;
      font-size: 14px;
      min-height: 30px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 4px;
      width: 360px;
      margin: 30px auto 10px auto;
      transition: opacity 0.3s ease;
    }
    .cell {
      width: 58px;
      height: 58px;
      border-radius: 50%;
      transition: transform 0.3s ease, opacity 1s ease;
    }
    .red    { background: radial-gradient(circle, #ff4d4d, #990000); }
    .green  { background: radial-gradient(circle, #66ff66, #006600); }
    .blue   { background: radial-gradient(circle, #66ccff, #003366); }
    .purple { background: radial-gradient(circle, #dca0ff, #440066); }
    .orange { background: radial-gradient(circle, #cc9955, #cc6600); }
    .highlight { box-shadow: 0 0 10px 4px #ffffff88; }
    .fade { opacity: 0; }
    .enemy-turn #board {
      pointer-events: none;
      opacity: 0.2;
    }
    #overlay, #endScreen, #mainMenu, #paramScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 999;
    }
    .floatText {
      position: absolute;
      font-size: 14px;
      font-weight: bold;
      pointer-events: none;
      animation: floatUp 3s ease forwards;
    }
    @keyframes floatUp {
      from { opacity: 1; transform: translateY(0); }
      to   { opacity: 0; transform: translateY(-30px); }
    }
    #overlay input {
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
      margin-top: 10px;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background: #6622cc;
      color: white;
    }
    #lightningButton {
      margin: 10px auto;
      display: none;
      background: #ffcc00;
      color: #000;
    }
  </style>
</head>
<body>
  <h1>üî• –ò–°–ö–†–ê: –ë–∏—Ç–≤–∞ v1.4 üî•</h1>
  <div id="topBar">
    <div>–í—ã:<br>‚ù§Ô∏è <span id="hp">200</span> <span id="healText"></span><br>üõ° <span id="shield">100</span> <span id="defText"></span><br>üîÆ <span id="mana">0</span></div>
    <div id="timerBarContainer"><div id="timerBar"></div></div>
    <div>–ú–æ–Ω—Å—Ç—Ä:<br>üíÄ <span id="enemyHp">100</span> <span id="enemyHealText"></span><br>üõ° <span id="enemyShield">100</span> <span id="enemyDefText"></span><br>üîÆ <span id="enemyMana">0</span></div>
  </div>
  <div id="battleLog">–ö–æ–º–±–æ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...</div>
  <div id="board"></div>
  <button id="lightningButton" onclick="useLightning()">‚ö° –ú–æ–ª–Ω–∏—è (20 –º–∞–Ω—ã)</button>  <div id="overlay" style="display:flex">
    <h2>–í–≤–µ–¥–∏—Ç–µ –∏–º—è:</h2>
    <input id="nickname" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
    <button onclick="goToMainMenu()">–î–∞–ª–µ–µ</button>
  </div>  <div id="mainMenu">
    <h2 id="welcome"></h2>
    <button onclick="startGame()">–í –±–æ–π!</button>
    <button onclick="openParams()">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  </div>  <div id="paramScreen">
    <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h2>
    <div>–û–ø—ã—Ç: <span id="xp">0</span> | –î–æ—Å—Ç—É–ø–Ω–æ –æ—á–∫–æ–≤: <span id="points">0</span></div>
    <div>
      –°–∏–ª–∞: <span id="str">1</span> <button onclick="upgrade('str')">+</button><br>
      –õ–æ–≤–∫–æ—Å—Ç—å: <span id="agi">1</span> <button onclick="upgrade('agi')">+</button><br>
      –ñ–∏–≤—É—á–µ—Å—Ç—å: <span id="vit">1</span> <button onclick="upgrade('vit')">+</button><br>
      –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: <span id="int">1</span> <button onclick="upgrade('int')">+</button><br>
      –£–¥–∞—á–∞: <span id="luck">1</span> <button onclick="upgrade('luck')">+</button>
    </div>
    <button onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
  </div>  <div id="endScreen" style="display:none">
    <h2 id="endMessage">–ü–æ–±–µ–¥–∞!</h2>
    <button onclick="backToMenu()">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
  </div><script>
// –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ ‚Äî –≤–∫–ª—é—á–∞—è –≤—Å—é –±–æ–µ–≤—É—é –ª–æ–≥–∏–∫—É, —Ä–∞—Å—á—ë—Ç –æ–ø—ã—Ç–∞ –∏ –ø—Ä–æ–∫–∞—á–∫—É...
</script></body>
</html>
<script>
let hp = 200, shield = 100, mana = 0;
let enemyHp = 100, enemyShield = 100, enemyMana = 0;
let isPlayerTurn = true;
let lightningUsed = false;
let playerName = "";
let experience = 0;
let levelThreshold = [100, 200, 400, 800, 1600];
let skillPoints = 0;
let stats = {
  strength: 1,
  agility: 1,
  vitality: 1,
  intellect: 1,
  luck: 1,
};

function startGame() {
  document.getElementById("startScreen").style.display = "none";
  document.getElementById("menuScreen").style.display = "block";
}

function openBattle() {
  document.getElementById("menuScreen").style.display = "none";
  document.getElementById("gameScreen").style.display = "block";
  initBattle();
}

function openStats() {
  document.getElementById("menuScreen").style.display = "none";
  document.getElementById("statsScreen").style.display = "block";
  updateStatsUI();
}

function backToMenu() {
  document.getElementById("statsScreen").style.display = "none";
  document.getElementById("gameScreen").style.display = "none";
  document.getElementById("menuScreen").style.display = "block";
}

function updateStatsUI() {
  document.getElementById("xpDisplay").innerText = experience;
  document.getElementById("pointsDisplay").innerText = skillPoints;
  document.getElementById("statStrength").innerText = stats.strength;
  document.getElementById("statAgility").innerText = stats.agility;
  document.getElementById("statVitality").innerText = stats.vitality;
  document.getElementById("statIntellect").innerText = stats.intellect;
  document.getElementById("statLuck").innerText = stats.luck;
}

function upgradeStat(stat) {
  if (skillPoints > 0) {
    stats[stat]++;
    skillPoints--;
    updateStatsUI();
  }
}

function initBattle() {
  hp = 200;
  shield = 100;
  mana = 0;
  enemyHp = 100;
  enemyShield = 100;
  enemyMana = 0;
  lightningUsed = false;
  isPlayerTurn = true;
  updateHUD();
  startTurn();
}

function updateHUD() {
  document.getElementById("hp").innerText = hp;
  document.getElementById("shield").innerText = shield;
  document.getElementById("mana").innerText = mana;
  document.getElementById("enemyHp").innerText = enemyHp;
  document.getElementById("enemyShield").innerText = enemyShield;
  document.getElementById("enemyMana").innerText = enemyMana;
  document.getElementById("lightningButton").style.display =
    isPlayerTurn && mana >= 20 ? "inline-block" : "none";
}

function useLightning() {
  if (isPlayerTurn && mana >= 20) {
    lightningUsed = true;
    mana -= 20;
    updateHUD();
  }
}

function startTurn() {
  isPlayerTurn = true;
  lightningUsed = false;
  updateHUD();
  // –ó–¥–µ—Å—å –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è, —Å–±–æ—Ä–∞ –∫–∞–º–Ω–µ–π –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —É—Ä–æ–Ω–∞
}

function endTurn() {
  applyEffects();
  updateHUD();
  if (enemyHp <= 0) {
    experience += mana;
    mana = 0;
    while (experience >= levelThreshold[0]) {
      experience -= levelThreshold.shift();
      skillPoints += 5;
    }
    backToMenu();
  } else {
    isPlayerTurn = false;
    enemyTurn();
  }
}

function applyEffects() {
  let baseDamage = 10; // –¥–æ–ø—É—Å—Ç–∏–º, –æ—Ç –∫—Ä–∞—Å–Ω—ã—Ö –∫–∞–º–Ω–µ–π
  let damage = Math.floor(baseDamage * (1 + stats.strength / 100));
  if (lightningUsed) damage += Math.floor(50 * (1 + stats.intellect / 100));
  let shieldDamage = Math.floor(damage / 2);
  let hpDamage = damage - shieldDamage;
  if (enemyShield >= shieldDamage) {
    enemyShield -= shieldDamage;
    enemyHp -= hpDamage;
  } else {
    let left = shieldDamage - enemyShield;
    enemyShield = 0;
    enemyHp -= hpDamage + left;
  }
}

function enemyTurn() {
  setTimeout(() => {
    let baseDamage = 10;
    let shieldDamage = Math.floor(baseDamage / 2);
    let hpDamage = baseDamage - shieldDamage;
    if (shield >= shieldDamage) {
      shield -= shieldDamage;
      hp -= hpDamage;
    } else {
      let left = shieldDamage - shield;
      shield = 0;
      hp -= hpDamage + left;
    }
    if (hp <= 0) {
      alert("–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!");
      backToMenu();
    } else {
      isPlayerTurn = true;
      updateHUD();
    }
  }, 1000);
}
</script>
